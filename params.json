{
  "name": "Using NetScaler CPX",
  "tagline": "Blog about CPX with working examples",
  "body": "## Getting to know Citrix NetScaler CPX\r\n\r\nCitrix NetScaler is a commercial load balancer that competes with open source load balancers such as HAProxy and Nginx. NetScaler is available as a container as well, in a product version known as NetScaler CPX. Even better, there is a free version available, called the CPX Express. For the rest of the blog post, I’m using my Mac laptop running OS X Sierra, and Docker for Mac version 1.12.\r\n\r\nCPX Express can be downloaded from [https://microloadbalancer.com] (https://microloadbalancer.com). Once you download the compressed file, you can create a docker image:\r\n\r\n```\r\n$ docker load -i ~/Downloads/cpx-11.1-48.10.gz\r\n```\r\n\r\nYou should now have the CPX image available:\r\n\r\n```\r\n$ docker images cpx\r\nREPOSITORY          TAG                 IMAGE ID                        \r\ncpx                 11.1-48.10          9c5a5e94c333        \r\n```\r\n\r\nCreate a container from this image:\r\n\r\n```\r\n$ docker run -dt -p 22  --ulimit core=-1 --privileged=true --name=cpx cpx:11.1-48.10\r\n275626b96389755a88362c8df3ae4851f13e45d22f502b29900612fc2da28444\r\n```\r\n\r\nDetermine the SSH port of this running container:\r\n\r\n```\r\n$ docker inspect --format='{{(index (index .NetworkSettings.Ports \"22/tcp\") 0).HostPort}}' cpx\r\n32849\r\n```\r\n\r\nLogin to the NetScaler CPX using the id/password combination of `root/linux`:\r\n\r\n```\r\n$ ssh -p 32849 root@127.0.0.1 \r\nThe authenticity of host '[127.0.0.1]:32849 ([127.0.0.1]:32849)' can't be established.\r\nECDSA key fingerprint is SHA256:N3dlhNYbvYjOPkbt9ogrg2fwwUDWPVs8JwvLuE64/RQ.\r\nAre you sure you want to continue connecting (yes/no)? yes\r\nWarning: Permanently added '[127.0.0.1]:32849' (ECDSA) to the list of known hosts.\r\nroot@127.0.0.1's password: \r\nWelcome to Ubuntu 14.04 LTS (GNU/Linux 3.19.0-39-generic x86_64)\r\n```\r\n\r\nOnce logged in, you can execute almost any regular NetScaler CLI command by passing the command to the `cli_script.sh` script. For example:\r\n\r\n```\r\nroot@275626b96389:~# cli_script.sh 'show ip'   \r\nexec: show ip\r\n    Ipaddress        Traffic Domain  Type             Mode     Arp      Icmp     Vserver  State\r\n    ---------        --------------  ----             ----     ---      ----     -------  ------\r\n1)  172.17.0.2       0               NetScaler IP     Active   Enabled  Enabled  NA       Enabled\r\n2)  192.0.0.1        0               SNIP             Active   Enabled  Enabled  NA       Enabled\r\nDone\r\n```\r\n\r\nIn the next blog we’ll see how to exercise the CPX’s primary function: load balancing.",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}