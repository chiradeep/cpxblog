<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Using NetScaler CPX by chiradeep</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Using NetScaler CPX</h1>
      <h2 class="project-tagline">Blog about CPX with working examples</h2>
      <a href="https://github.com/chiradeep/cpxblog" class="btn">View on GitHub</a>
      <a href="https://github.com/chiradeep/cpxblog/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/chiradeep/cpxblog/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="getting-to-know-citrix-netscaler-cpx" class="anchor" href="#getting-to-know-citrix-netscaler-cpx" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Getting to know Citrix NetScaler CPX</h2>

<p>Citrix NetScaler is a commercial load balancer that competes with open source load balancers such as HAProxy and Nginx. NetScaler is available as a container as well, in a product version known as NetScaler CPX. Even better, there is a free version available, called the CPX Express. For the rest of the blog post, I’m using my Mac laptop running OS X Sierra, and Docker for Mac version 1.12.</p>

<p>CPX Express can be downloaded from <a href="https://microloadbalancer.com">https://microloadbalancer.com</a>. Once you download the compressed file, you can create a docker image:</p>

<pre><code>$ docker load -i ~/Downloads/cpx-11.1-48.10.gz
</code></pre>

<p>You should now have the CPX image available:</p>

<pre><code>$ docker images cpx
REPOSITORY          TAG                 IMAGE ID                        
cpx                 11.1-48.10          9c5a5e94c333        
</code></pre>

<p>Create a container from this image:</p>

<pre><code>$ docker run -dt -p 22  --ulimit core=-1 --privileged=true --name=cpx cpx:11.1-48.10
275626b96389755a88362c8df3ae4851f13e45d22f502b29900612fc2da28444
</code></pre>

<p>Determine the SSH port of this running container:</p>

<pre><code>$ docker inspect --format='{{(index (index .NetworkSettings.Ports "22/tcp") 0).HostPort}}' cpx
32849
</code></pre>

<p>Login to the NetScaler CPX using the id/password combination of <code>root/linux</code>:</p>

<pre><code>$ ssh -p 32849 root@127.0.0.1 
The authenticity of host '[127.0.0.1]:32849 ([127.0.0.1]:32849)' can't be established.
ECDSA key fingerprint is SHA256:N3dlhNYbvYjOPkbt9ogrg2fwwUDWPVs8JwvLuE64/RQ.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '[127.0.0.1]:32849' (ECDSA) to the list of known hosts.
root@127.0.0.1's password: 
Welcome to Ubuntu 14.04 LTS (GNU/Linux 3.19.0-39-generic x86_64)
</code></pre>

<p>Once logged in, you can execute almost any regular NetScaler CLI command by passing the command to the <code>cli_script.sh</code> script. For example:</p>

<pre><code>root@275626b96389:~# cli_script.sh 'show ip'   
exec: show ip
    Ipaddress        Traffic Domain  Type             Mode     Arp      Icmp     Vserver  State
    ---------        --------------  ----             ----     ---      ----     -------  ------
1)  172.17.0.2       0               NetScaler IP     Active   Enabled  Enabled  NA       Enabled
2)  192.0.0.1        0               SNIP             Active   Enabled  Enabled  NA       Enabled
Done
</code></pre>

<p>In the next blog we’ll see how to exercise the CPX’s primary function: load balancing.</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/chiradeep/cpxblog">Using NetScaler CPX</a> is maintained by <a href="https://github.com/chiradeep">chiradeep</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
